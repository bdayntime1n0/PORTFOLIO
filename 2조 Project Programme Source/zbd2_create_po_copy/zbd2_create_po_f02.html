<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ZBD2_CREATE_PO_F02</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZBD2_CREATE_PO_F02</h2>
<h3> Description: Include ZBD212_ASSG_W6_0723_F02</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
***&---------------------------------------------------------------------*<br />
***&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZBD212_ASSG_W6_0723_F02<br />
***&---------------------------------------------------------------------*<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_data_changed<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_DATA_CHANGED<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ONF4_AFTER<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_DATA_CHANGED&nbsp;&nbsp;USING&nbsp;ER_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_CHANGED_DATA_PROTOCOL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_ONF4_AFTER&nbsp;TYPE&nbsp;C.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LS_MOD_CELL&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
**&nbsp;&nbsp;DATA:&nbsp;LS_INSERTED_ROW&nbsp;TYPE&nbsp;LVC_S_MOCE.<br />
**&nbsp;&nbsp;DATA:&nbsp;LV_CHK&nbsp;TYPE&nbsp;C.<br />
**<br />
**&nbsp;&nbsp;CLEAR:&nbsp;LS_MOD_CELL,&nbsp;LS_INSERTED_ROW,&nbsp;LV_CHK.<br />
***<br />
***&nbsp;&nbsp;PERFORM&nbsp;ALV_GET_EVENT_OBJECT_GRID.<br />
***<br />
***&nbsp;&nbsp;CHECK&nbsp;gRF_gui_obj&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
***<br />
***&nbsp;&nbsp;CASE&nbsp;gRF_gui_obj.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid2.<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_CHANGE_DATA_GT_DATA&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid3.<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_CHANGE_DATA_GT_DATA1&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid4.<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_CHANGE_DATA_GT_DATA2&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid6.<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_CHANGE_DATA_GT_DATA4&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid7.<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ALV_CHANGE_DATA_GT_DATA6&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED.<br />
***&nbsp;&nbsp;ENDCASE.<br />
**<br />
***&nbsp;&nbsp;IF&nbsp;R_CHANGE&nbsp;=&nbsp;'X'.<br />
***&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;ER_DATA_CHANGED-&gt;MT_MOD_CELLS&nbsp;INTO&nbsp;LS_MOD_CELL.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DATA.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_MOD_CELL-ROW_ID.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LS_MOD_CELL-FIELDNAME.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CODE_CHANGE_KTEXT&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_MOD_CELL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'VERAK'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CODE_CHANGE_VERAK&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_MOD_CELL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WAERS'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSLATE&nbsp;GS_DATA-WAERS&nbsp;TO&nbsp;UPPER&nbsp;CASE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CODE_CHANGE_WAERS&nbsp;USING&nbsp;&nbsp;ER_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_MOD_CELL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-ICON&nbsp;=&nbsp;ICON_YELLOW_LIGHT.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-MSG&nbsp;=&nbsp;'###&nbsp;###&nbsp;####&nbsp;##&nbsp;###&nbsp;####&nbsp;##&nbsp;###&nbsp;#####.'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_MOD_CELL-ROW_ID.<br />
**<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_user_command<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_UCOMM<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_USER_COMMAND&nbsp;&nbsp;USING&nbsp;E_UCOMM&nbsp;TYPE&nbsp;SY-UCOMM.<br />
**<br />
***-----------------*<br />
***&nbsp;ALV&nbsp;##&nbsp;###&nbsp;CODE#&nbsp;SCREEN&nbsp;#&nbsp;PAI&nbsp;#<br />
***&nbsp;##&nbsp;###&nbsp;####&nbsp;##&nbsp;##<br />
***&nbsp;PAI&nbsp;Event&nbsp;##.<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;SET_NEW_OK_CODE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEW_CODE&nbsp;=&nbsp;E_UCOMM.<br />
**&nbsp;&nbsp;CLEAR&nbsp;E_UCOMM.<br />
**<br />
**<br />
***-----------------*<br />
***&nbsp;#&nbsp;Screen#&nbsp;2#&nbsp;##&nbsp;Grid&nbsp;#####&nbsp;##&nbsp;Toolbar&nbsp;Button&nbsp;##.<br />
***&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_CODE&nbsp;TYPE&nbsp;SY-UCOMM.<br />
***&nbsp;&nbsp;PERFORM&nbsp;ALV_GET_EVENT_OBJECT_GRID.&nbsp;"&nbsp;EVENT&nbsp;GRID&nbsp;GET.<br />
***<br />
***&nbsp;&nbsp;CASE&nbsp;gRF_gui_obj.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid1.&nbsp;&nbsp;"&nbsp;Screen&nbsp;0100<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_CODE&nbsp;=&nbsp;'%CON1'.&nbsp;&nbsp;"&nbsp;Container&nbsp;Name(###&nbsp;###&nbsp;##&nbsp;##).<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;E_UCOMM.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SAV1'.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid2.&nbsp;&nbsp;"&nbsp;Screen&nbsp;0100<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_CODE&nbsp;=&nbsp;'%CON2'.&nbsp;&nbsp;"&nbsp;Container&nbsp;Name(###&nbsp;###&nbsp;##&nbsp;##).<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;E_UCOMM.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SAV2'.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***&nbsp;&nbsp;ENDCASE.<br />
***<br />
***&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;SET_NEW_OK_CODE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEW_CODE&nbsp;=&nbsp;'DUMMY'.<br />
***&nbsp;&nbsp;CLEAR&nbsp;E_UCOMM.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_event_toolbar<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_OBJECT<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_INTERACTIVE<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_EVENT_TOOLBAR&nbsp;&nbsp;USING&nbsp;E_OBJECT&nbsp;TYPE&nbsp;REF&nbsp;TO<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_ALV_EVENT_TOOLBAR_SET<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_INTERACTIVE&nbsp;TYPE&nbsp;C.<br />
**&nbsp;&nbsp;DATA&nbsp;:&nbsp;PS_TOOLBAR&nbsp;&nbsp;TYPE&nbsp;STB_BUTTON.<br />
**<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;PS_TOOLBAR.<br />
**&nbsp;&nbsp;PS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;'3'.<br />
**&nbsp;&nbsp;APPEND&nbsp;PS_TOOLBAR&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
**<br />
***&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;PS_TOOLBAR.<br />
***&nbsp;&nbsp;PS_TOOLBAR-FUNCTION&nbsp;=&nbsp;'ALLSEL'.<br />
***&nbsp;&nbsp;PS_TOOLBAR-ICON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_SELECT_ALL.<br />
***&nbsp;&nbsp;APPEND&nbsp;PS_TOOLBAR&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
***<br />
***&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;PS_TOOLBAR.<br />
***&nbsp;&nbsp;PS_TOOLBAR-FUNCTION&nbsp;=&nbsp;'DESEL'.<br />
***&nbsp;&nbsp;PS_TOOLBAR-ICON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_DESELECT_ALL.<br />
***&nbsp;&nbsp;APPEND&nbsp;PS_TOOLBAR&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
**<br />
****-----------------*<br />
***&nbsp;Screen#&nbsp;###&nbsp;Toolbar&nbsp;Button&nbsp;##(Grid&nbsp;###&nbsp;##&nbsp;##).<br />
***&nbsp;&nbsp;CASE&nbsp;GV_SCREEN.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CON1'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_TOOLBAR-FUNCTION&nbsp;&nbsp;=&nbsp;'SAV1'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_TOOLBAR-ICON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_SYSTEM_SAVE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Save1'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;PS_TOOLBAR&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
***<br />
***&nbsp;&nbsp;CASE&nbsp;GV_SCREEN.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CON2'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_TOOLBAR-FUNCTION&nbsp;&nbsp;=&nbsp;'SAV2'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_TOOLBAR-ICON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_SYSTEM_SAVE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'Save2'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;PS_TOOLBAR&nbsp;TO&nbsp;E_OBJECT-&gt;MT_TOOLBAR.<br />
***&nbsp;&nbsp;ENDCASE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_menu_button<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_OBJECT<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_UCOMM<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_MENU_BUTTON&nbsp;&nbsp;USING&nbsp;E_OBJECT&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_CTMENU<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_UCOMM&nbsp;&nbsp;TYPE&nbsp;SY-UCOMM.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_onf4<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_FIELDNAME<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_FIELDVALUE<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_ROW_NO<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_EVENT_DATA<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ET_BAD_CELLS<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_DISPLAY<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_ONF4&nbsp;&nbsp;USING&nbsp;E_FIELDNAME&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_FNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_FIELDVALUE&nbsp;&nbsp;TYPE&nbsp;LVC_VALUE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_EVENT_DATA<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS&nbsp;&nbsp;TYPE&nbsp;LVC_T_MODI<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;C.<br />
**<br />
**&nbsp;&nbsp;PERFORM&nbsp;ALV_GET_EVENT_OBJECT_GRID.&nbsp;"&nbsp;EVENT&nbsp;GRID&nbsp;GET.<br />
**<br />
**&nbsp;&nbsp;CASE&nbsp;GRF_GUI_OBJ.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_GRID2.<br />
***--&nbsp;ALV&nbsp;Event&nbsp;-&nbsp;ALV&nbsp;F4<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NLPLA'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NLPLA&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NLTYP'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NLTYP&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid4.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NLPLA'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NLPLA1&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NLTYP'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NLTYP1&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid6.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NLPLA'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NLPLA2&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NLTYP'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NLTYP2&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;E_FIELDNAME&nbsp;=&nbsp;'NUNIT'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_F4_FIELD_NUNIT2&nbsp;USING&nbsp;&nbsp;E_FIELDVALUE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ER_EVENT_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_BAD_CELLS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**&nbsp;&nbsp;ENDCASE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_changed_finished<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_MODIFIED<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ET_GOOD_CELLS<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_CHANGED_FINISHED&nbsp;&nbsp;USING&nbsp;E_MODIFIED&nbsp;TYPE&nbsp;C<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_GOOD_CELLS&nbsp;TYPE&nbsp;LVC_T_MODI.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LS_GOOD_CELL&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
**&nbsp;&nbsp;IF&nbsp;E_MODIFIED&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_GOOD_CELL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;ET_GOOD_CELLS&nbsp;INTO&nbsp;LS_GOOD_CELL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DATA.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_GOOD_CELL-ROW_ID.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LS_GOOD_CELL-FIELDNAME.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CHECK'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DATA-HUIDENT_PARENT&nbsp;IS&nbsp;NOT&nbsp;INITIAL.&nbsp;"&nbsp;BOX&nbsp;HU<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-CHECK&nbsp;=&nbsp;LS_GOOD_CELL-VALUE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;TRANSPORTING&nbsp;CHECK<br />
***WHERE&nbsp;HUIDENT_PARENT&nbsp;=&nbsp;GS_DATA-HUIDENT_PARENT.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DATA-HUIDENT_TOP&nbsp;IS&nbsp;NOT&nbsp;INITIAL.&nbsp;"&nbsp;PLT&nbsp;HU<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-CHECK&nbsp;=&nbsp;LS_GOOD_CELL-VALUE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;TRANSPORTING&nbsp;CHECK<br />
***WHERE&nbsp;HUIDENT_TOP&nbsp;=&nbsp;GS_DATA-HUIDENT_TOP.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
***MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;INDEX&nbsp;LS_GOOD_CELL-ROW_ID&nbsp;TRANSPORTING<br />
***CHECK.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;REFRESH_TABLE_DISPLAY&nbsp;USING&nbsp;GO_GRID&nbsp;'X'.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_double_click<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_COLUMN<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_ROW_NO<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_DOUBLE_CLICK&nbsp;&nbsp;USING&nbsp;E_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROW<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_COLUMN_ID&nbsp;TYPE&nbsp;LVC_S_COL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROID.<br />
**<br />
***&nbsp;&nbsp;PERFORM&nbsp;ALV_GET_EVENT_OBJECT_GRID.&nbsp;"&nbsp;EVENT&nbsp;GRID&nbsp;GET.<br />
***<br />
***&nbsp;&nbsp;CASE&nbsp;gRF_gui_obj.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid1.<br />
***&nbsp;&nbsp;ENDCASE.<br />
**&nbsp;&nbsp;IF&nbsp;E_COLUMN_ID-FIELDNAME&nbsp;=&nbsp;'KOSTL'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MANDT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;CSKS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@DATA(LV_DATA)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KOSTL&nbsp;=&nbsp;@GS_DATA-KOSTL.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PARAMETER&nbsp;ID&nbsp;'KOS'&nbsp;FIELD&nbsp;GS_DATA-KOSTL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PARAMETER&nbsp;ID&nbsp;'CAC'&nbsp;FIELD&nbsp;P_KOKRS.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;'KS03'&nbsp;AND&nbsp;SKIP&nbsp;FIRST&nbsp;SCREEN.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000&nbsp;WITH&nbsp;TEXT-E17&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"&nbsp;##&nbsp;######&nbsp;####&nbsp;##&nbsp;###&nbsp;######.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_hotspot_click<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW_ID<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_COLUMN_ID<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_ROW_NO<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_HOTSPOT_CLICK&nbsp;&nbsp;USING&nbsp;&nbsp;E_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROW<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_COLUMN_ID&nbsp;TYPE&nbsp;LVC_S_COL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROID.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LS_DATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZTBD2_12_07.<br />
**&nbsp;&nbsp;DATA:&nbsp;LT_DATA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZTBD2_12_07.<br />
**<br />
**&nbsp;&nbsp;CLEAR:&nbsp;LR_TABLE,&nbsp;LS_DATA,&nbsp;LT_DATA[],&nbsp;LR_TABLE,&nbsp;LR_COLUMNS,&nbsp;LR_COLUMN,&nbsp;LR_DISPLAY.<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;E_COLUMN_ID-FIELDNAME&nbsp;=&nbsp;'TAB'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZTBD2_12_07<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;&nbsp;LS_DATA<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KOSTL&nbsp;=&nbsp;GS_DATA-KOSTL<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KOKRS&nbsp;=&nbsp;GS_DATA-KOKRS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KTEXT&nbsp;=&nbsp;GS_DATA-KTEXT<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WAERS&nbsp;=&nbsp;GS_DATA-WAERS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;VERAK&nbsp;=&nbsp;GS_DATA-VERAK.<br />
**<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_DATA&nbsp;TO&nbsp;LT_DATA.<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZTBD2_12_07<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;&nbsp;TABLE&nbsp;LT_DATA<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KOSTL&nbsp;=&nbsp;GS_DATA-KOSTL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KOKRS&nbsp;=&nbsp;GS_DATA-KOKRS.<br />
**<br />
**<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CL_SALV_TABLE=&gt;FACTORY(<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_DATA[]&nbsp;).<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SET_SALV_DISPLAY.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LR_TABLE-&gt;SET_SCREEN_POPUP(<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_COLUMN&nbsp;=&nbsp;1<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END_COLUMN&nbsp;&nbsp;=&nbsp;120<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_LINE&nbsp;&nbsp;=&nbsp;1<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END_LINE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;10&nbsp;).<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LR_TABLE-&gt;DISPLAY(&nbsp;).<br />
**<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**<br />
***&nbsp;&nbsp;PERFORM&nbsp;ALV_GET_EVENT_OBJECT_GRID.&nbsp;"&nbsp;EVENT&nbsp;GRID&nbsp;GET.<br />
***<br />
***&nbsp;&nbsp;CASE&nbsp;gRF_gui_obj.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid1.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;E_COLUMN_ID-FIELDNAME.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AUFNR'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;GT_DATA-AUFNR&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PARAMETER&nbsp;ID&nbsp;'ANR'&nbsp;FIELD&nbsp;GT_DATA-AUFNR.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;'CO03'&nbsp;AND&nbsp;SKIP&nbsp;FIRST&nbsp;SCREEN.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***&nbsp;&nbsp;ENDCASE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;alv_button_click<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_COL_ID<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_ROW_NO<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_BUTTON_CLICK&nbsp;&nbsp;USING&nbsp;&nbsp;E_COLUMN_ID&nbsp;TYPE&nbsp;LVC_S_COL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_ROW_NO	&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROID.<br />
**<br />
**&nbsp;&nbsp;PERFORM&nbsp;ALV_GET_EVENT_OBJECT_GRID.&nbsp;"&nbsp;EVENT&nbsp;GRID&nbsp;GET.<br />
**<br />
**<br />
**<br />
***&nbsp;&nbsp;CASE&nbsp;gRF_gui_obj.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;go_grid1.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;E_COLUMN_ID-FIELDNAME.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***&nbsp;&nbsp;ENDCASE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;ALV_GET_EVENT_OBJECT_GRID<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_GET_EVENT_OBJECT_GRID&nbsp;.<br />
**<br />
**&nbsp;&nbsp;"&nbsp;EVENT&nbsp;#&nbsp;###&nbsp;GRID#&nbsp;##&nbsp;##&nbsp;METHOD<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GRF_ALV_EVT,&nbsp;GRF_GUI_OBJ.<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;GET_CURRENT_EVENT_OBJECT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;RECEIVING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EVENT_OBJECT&nbsp;=&nbsp;GRF_ALV_EVT.<br />
**<br />
**&nbsp;&nbsp;CHECK&nbsp;GRF_ALV_EVT&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
**&nbsp;&nbsp;GRF_GUI_OBJ&nbsp;=&nbsp;GRF_ALV_EVT-&gt;EVENT_SRC.<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;GRF_GUI_OBJ&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;GRF_GUI_TMP&nbsp;=&nbsp;GRF_GUI_OBJ.<br />
**&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;GRF_GUI_OBJ&nbsp;=&nbsp;GRF_GUI_TMP.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CREATE_CONTAINER<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_CUSTOM_CONTAINER<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CREATE_CONTAINER&nbsp;&nbsp;USING&nbsp;P_CONS&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_CUSTOM_CONTAINER<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_CONS_NAME&nbsp;TYPE&nbsp;CHAR10.<br />
**&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;P_CONS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;P_CONS_NAME.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CREATE_GRID<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_CUSTOM_CONTAINER<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CREATE_GRID&nbsp;&nbsp;USING&nbsp;PO_GRID&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_CONS&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_CUSTOM_CONTAINER.<br />
**<br />
**&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;PO_GRID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;P_CONS.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CREATE_LAYOUT<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CREATE_LAYOUT&nbsp;&nbsp;USING&nbsp;P_CON_NAME&nbsp;&nbsp;P_EDIT.<br />
**<br />
**&nbsp;&nbsp;GS_layout-CWIDTH_OPT&nbsp;=&nbsp;'A'.<br />
**&nbsp;&nbsp;GS_layout-NO_ROWMARK&nbsp;=&nbsp;'&nbsp;'.<br />
**&nbsp;&nbsp;GS_layout-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;GS_layout-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_EDIT.<br />
**<br />
**&nbsp;&nbsp;Gs_layout-NO_TOTLINE&nbsp;=&nbsp;SPACE.<br />
***&nbsp;&nbsp;GS_LAYOUT-NUMC_TOTAL&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;Gs_layout-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;&nbsp;"ROW&nbsp;####<br />
**&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;=&nbsp;'CELLSTYL'.&nbsp;&nbsp;"&nbsp;Cell&nbsp;Style&nbsp;"&nbsp;attribute&nbsp;##.<br />
**&nbsp;&nbsp;GS_LAYOUT-CTAB_FNAME&nbsp;=&nbsp;'CELLSCOL'.&nbsp;&nbsp;&nbsp;"&nbsp;Cell&nbsp;Color<br />
***&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'LINE_CL'.<br />
**<br />
**&nbsp;&nbsp;"LAYOUT&nbsp;VARIANT&nbsp;##&nbsp;##<br />
**&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
**&nbsp;&nbsp;GS_VARIANT-HANDLE&nbsp;=&nbsp;P_CON_NAME.<br />
**&nbsp;&nbsp;GV_SAVE&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;LAYOUT&nbsp;VARIANT&nbsp;SAVE&nbsp;USE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;EXCLUDE_TB_FUNCTIONS<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;EXCLUDE_TB_FUNCTIONS&nbsp;&nbsp;USING&nbsp;PO_GRID&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
**<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_EXCLUDE,&nbsp;GT_EXCLUDE[].<br />
**<br />
**&nbsp;&nbsp;PERFORM&nbsp;APPEND_EXCLUDE_FUNCTIONS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TABLES&nbsp;GT_EXCLUDE[]<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_EXCL_ALL,<br />
**&nbsp;&nbsp;USING&nbsp;:&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_UNDO,&nbsp;"&nbsp;####&nbsp;&LOCAL&UNDO<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_GRAPH,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_INFO,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CHECK,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_REFRESH,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_COPY,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_COPY_ROW,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#&nbsp;##.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_CUT,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_DELETE_ROW,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_INSERT_ROW,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_APPEND_ROW,&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_MOVE_ROW,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_PASTE,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_PASTE_NEW_ROW.&nbsp;"&nbsp;####.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CREATE_ALV_EVENT<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CREATE_ALV_EVENT&nbsp;&nbsp;USING&nbsp;&nbsp;PO_GRID&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
**<br />
***&nbsp;&nbsp;GO_GRID-&gt;SET_READY_FOR_INPUT(&nbsp;I_READY_FOR_INPUT&nbsp;=&nbsp;0&nbsp;).&nbsp;"&nbsp;####&nbsp;0#,&nbsp;1##&nbsp;edit&nbsp;mode<br />
**<br />
**<br />
**<br />
**&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_EVENT_RECEIVER.<br />
**<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_USER_COMMAND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PO_GRID.<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_DATA_CHANGED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PO_GRID.<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_CHANGED_FINISHED&nbsp;FOR&nbsp;PO_GRID.<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_HOTSPOT_CLICK&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PO_GRID.<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_DOUBLE_CLICK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PO_GRID.<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PO_GRID.<br />
**&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT_RECEIVER-&gt;HANDLE_ONF4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;PO_GRID.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CREATE_FIELDCATALOG<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CREATE_FIELDCATALOG&nbsp;&nbsp;USING&nbsp;PV_TABLE&nbsp;PV_FCAT.<br />
**<br />
**&nbsp;&nbsp;ASSIGN&nbsp;(PV_FCAT)&nbsp;TO&nbsp;&lt;GFS_T_FCAT&gt;.<br />
**<br />
**&nbsp;&nbsp;"&nbsp;Field&nbsp;catalog&nbsp;is&nbsp;must&nbsp;be&nbsp;via&nbsp;dictionary<br />
**&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LVC_FIELDCATALOG_MERGE'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PV_TABLE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_INTERNAL_TABNAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PV_TABLE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BYPASSING_BUFFER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;C_X<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;GFS_T_FCAT&gt;<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INCONSISTENT_INTERFACE&nbsp;=&nbsp;1<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S901(ZCMV1).&nbsp;&nbsp;"&nbsp;Failed&nbsp;create&nbsp;field&nbsp;fatalog<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;FIELD_SETTING_CALL<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;FIELD_SETTING_CALL&nbsp;&nbsp;USING&nbsp;PV_STR&nbsp;PV_FCAT.<br />
**<br />
**&nbsp;&nbsp;ASSIGN&nbsp;(PV_FCAT)&nbsp;TO&nbsp;&lt;GFS_T_FCAT&gt;.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&lt;GFS_T_FCAT&gt;&nbsp;ASSIGNING&nbsp;&lt;GFS_S_FCAT&gt;.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;PV_STR.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ZSBD2_12_07'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;&lt;GFS_S_FCAT&gt;-FIELDNAME.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KOSTL'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;C_X.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZTBD2_12_07'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'KOSTL'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-FIX_COLUMN&nbsp;=&nbsp;C_X.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'#####'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'#####'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'#####'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'#####'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-F4AVAILABL&nbsp;&nbsp;=&nbsp;C_X.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZTBD2_12_07'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'KTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-FIX_COLUMN&nbsp;=&nbsp;C_X.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'#######'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'#######'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'#######'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-F4AVAILABL&nbsp;&nbsp;=&nbsp;C_X.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'VERAK'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZTBD2_12_07'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'VERAK'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'###'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WAERS'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZTBD2_12_07'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'###'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'LTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZTBD2_12_07'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'LTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'#####'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'#####'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'#####'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'#####'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ICON'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;C_X.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-FIX_COLUMN&nbsp;=&nbsp;C_X.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'ID'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'ID'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'ID'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MSG'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;&nbsp;=&nbsp;'###'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'TAB'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-HOTSPOT&nbsp;&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-JUST&nbsp;=&nbsp;'C'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'######'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;&nbsp;=&nbsp;'######'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS&nbsp;.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-NO_OUT&nbsp;&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_S&nbsp;=&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_M&nbsp;=&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&lt;GFS_S_FCAT&gt;-SCRTEXT_L&nbsp;=&nbsp;&lt;GFS_S_FCAT&gt;-COLTEXT.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&lt;gfs_s_fcat&gt;-colddictxt&nbsp;=&nbsp;'M'.<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;SET_STYLE_ALV<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_DATA<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GS_DATA<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;SET_STYLE_ALV&nbsp;&nbsp;TABLES&nbsp;&nbsp;PT_TABLE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;PS_TABLE.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;PT_TABLE&nbsp;INTO&nbsp;PS_TABLE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MODIFY_LINE_DATA&nbsp;CHANGING&nbsp;PS_TABLE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;PT_TABLE&nbsp;FROM&nbsp;PS_TABLE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;PS_TABLE.<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;MODIFY_LINE_DATA<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;PS_TABLE<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;MODIFY_LINE_DATA&nbsp;&nbsp;CHANGING&nbsp;FS_DATA&nbsp;LIKE&nbsp;GS_DATA.<br />
**<br />
**&nbsp;&nbsp;PERFORM&nbsp;FILL_CELL_STYLNSCOL&nbsp;CHANGING&nbsp;FS_DATA.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;FILL_CELL_STYLNSCOL<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;FS_DATA<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;FILL_CELL_STYLNSCOL&nbsp;&nbsp;CHANGING&nbsp;FS_LIST&nbsp;LIKE&nbsp;GS_DATA.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LT_CELLSTYL&nbsp;TYPE&nbsp;LVC_S_STYL&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_CELLSCOL&nbsp;TYPE&nbsp;LVC_S_SCOL&nbsp;OCCURS&nbsp;0&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;LT_CELLSTYL.<br />
**&nbsp;&nbsp;REFRESH&nbsp;LT_CELLSCOL.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ICON'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KOSTL'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;R_CHANGE&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_ENABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'VERAK'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;R_CHANGE&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_ENABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WAERS'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;R_CHANGE&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_ENABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'LTEXT'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MSG'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CELL_FILL_CELLSTYL&nbsp;TABLES&nbsp;LT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;GS_FIELDCAT-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED.&nbsp;"BTN###<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
**<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;fs_list-lock_flag&nbsp;=&nbsp;'E'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;cell_fill_cellscol&nbsp;TABLES&nbsp;lt_cellscol<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;gs_fieldcat-fieldname<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'3'&nbsp;'1'&nbsp;'1'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;FS_LIST-CELLSTYL.<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;LT_CELLSTYL[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;LINES&nbsp;OF&nbsp;LT_CELLSTYL&nbsp;INTO&nbsp;TABLE&nbsp;FS_LIST-CELLSTYL.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;FS_LIST-CELLSCOL.<br />
**&nbsp;&nbsp;IF&nbsp;LT_CELLSCOL[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;LINES&nbsp;OF&nbsp;LT_CELLSCOL&nbsp;INTO&nbsp;TABLE&nbsp;FS_LIST-CELLSCOL.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CELL_FILL_CELLSTYL<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;LT_CELLSTYL<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GS_FIELDCAT_FIELDNAME<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISA<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CELL_FILL_CELLSTYL&nbsp;&nbsp;TABLES&nbsp;PT_CELLSTYL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE(P_FNAME)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE(P_STYPE).<br />
**<br />
**&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_CELLSTYL&nbsp;TYPE&nbsp;LVC_S_STYL.<br />
**<br />
**&nbsp;&nbsp;LS_CELLSTYL-FIELDNAME&nbsp;=&nbsp;P_FNAME.<br />
**&nbsp;&nbsp;LS_CELLSTYL-STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_STYPE.<br />
**<br />
**&nbsp;&nbsp;INSERT&nbsp;LS_CELLSTYL&nbsp;INTO&nbsp;TABLE&nbsp;PT_CELLSTYL.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;SORT_SETTING_CALL<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;SORT_SETTING_CALL&nbsp;&nbsp;USING&nbsp;PV_FCAT&nbsp;PV_SORT&nbsp;PV_ASCD.<br />
**<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_SORT_COL,&nbsp;GS_SORT_COL.<br />
***<br />
***&nbsp;&nbsp;ASSIGN&nbsp;(pv_fcat)&nbsp;TO&nbsp;&lt;gfs_t_fcat&gt;.<br />
***&nbsp;&nbsp;ASSIGN&nbsp;(pv_sort)&nbsp;TO&nbsp;&lt;gfs_t_sort&gt;.<br />
***<br />
***&nbsp;&nbsp;CASE&nbsp;pv_sort.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'GT_SORT'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Set&nbsp;key&nbsp;field&nbsp;in&nbsp;Field&nbsp;catalog<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&lt;gfs_t_fcat&gt;&nbsp;ASSIGNING&nbsp;&lt;gfs_s_fcat&gt;&nbsp;WHERE&nbsp;key&nbsp;EQ&nbsp;'X'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gs_sort_col-fieldname&nbsp;=&nbsp;&lt;gfs_s_fcat&gt;-fieldname.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;gs_sort_col&nbsp;TO&nbsp;gt_sort_col.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
***&nbsp;&nbsp;ENDCASE.<br />
***<br />
***&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'LVC_SORT_DIALOG'<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_fieldcat&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gfs_t_fcat&gt;<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_selected_cols&nbsp;=&nbsp;gt_sort_col<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_ascending&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;pv_ascd&nbsp;&nbsp;&nbsp;"&nbsp;'X'&nbsp;:&nbsp;Ascending<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SUBTOTALS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
****&nbsp;&nbsp;&nbsp;IMPORTING<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;E_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
***&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ct_sort&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;gfs_t_sort&gt;<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;no_change&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
***<br />
***&nbsp;&nbsp;IF&nbsp;sy-subrc&nbsp;&lt;&gt;&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;s902(zcmv).&nbsp;&nbsp;"&nbsp;Failed&nbsp;create&nbsp;sort&nbsp;catalog<br />
***&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
***&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;"&nbsp;for&nbsp;necessary<br />
**<br />
***&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;&lt;fs_t_sort&gt;&nbsp;ASSIGNING&nbsp;&lt;fs_s_sort&gt;.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;pv_sort.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'GT_SORT'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;&lt;fs_s_sort&gt;-fieldname.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ICON'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;&lt;fs_t_sort&gt;.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'KUNNR'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_s_sort&gt;-spos&nbsp;=&nbsp;'1'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_s_sort&gt;-up&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fs_s_sort&gt;-down&nbsp;=&nbsp;'X'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
***&nbsp;&nbsp;ENDLOOP.<br />
***<br />
***&nbsp;&nbsp;DATA&nbsp;:&nbsp;ls_sort&nbsp;LIKE&nbsp;lvc_s_sort.<br />
***&nbsp;&nbsp;ls_sort-spos&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'2'.<br />
***&nbsp;&nbsp;ls_sort-fieldname&nbsp;=&nbsp;'NAME1'.<br />
***&nbsp;&nbsp;ls_sort-up&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
***&nbsp;&nbsp;APPEND&nbsp;ls_sort&nbsp;TO&nbsp;&lt;fs_t_sort&gt;.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;DROPDOWN_TABLE<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;DROPDOWN_TABLE&nbsp;&nbsp;USING&nbsp;PO_GRID&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
**<br />
***Declarations&nbsp;for&nbsp;drop&nbsp;down&nbsp;lists&nbsp;in&nbsp;ALV.<br />
**&nbsp;&nbsp;DATA:&nbsp;LT_DROPDOWN&nbsp;TYPE&nbsp;LVC_T_DROP,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DROPDOWN&nbsp;TYPE&nbsp;LVC_S_DROP.<br />
**<br />
**<br />
****First&nbsp;SLART&nbsp;listbox&nbsp;(handle&nbsp;'1').<br />
***&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'1'.<br />
***&nbsp;&nbsp;ls_dropdown-value&nbsp;=&nbsp;'P&nbsp;####'.<br />
***&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
***<br />
***&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'1'.<br />
***&nbsp;&nbsp;ls_dropdown-value&nbsp;=&nbsp;'I&nbsp;####'.<br />
***&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
***<br />
***&nbsp;&nbsp;ls_dropdown-handle&nbsp;=&nbsp;'1'.<br />
***&nbsp;&nbsp;ls_dropdown-value&nbsp;=&nbsp;''.<br />
***&nbsp;&nbsp;APPEND&nbsp;ls_dropdown&nbsp;TO&nbsp;lt_dropdown.<br />
***<br />
****method&nbsp;to&nbsp;display&nbsp;the&nbsp;dropdown&nbsp;in&nbsp;ALV<br />
***&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;po_grid-&gt;set_drop_down_table<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_drop_down&nbsp;=&nbsp;lt_dropdown.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CREATE_SEARCH_HELP<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CREATE_SEARCH_HELP&nbsp;USING&nbsp;&nbsp;PO_GRID&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LT_F4&nbsp;TYPE&nbsp;LVC_T_F4&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
**<br />
***&nbsp;&nbsp;lt_f4-fieldname&nbsp;&nbsp;&nbsp;=&nbsp;'PROJECT_CD'.<br />
***&nbsp;&nbsp;lt_f4-register&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;c_x.<br />
***&nbsp;&nbsp;lt_f4-getbefore&nbsp;&nbsp;&nbsp;=&nbsp;c_x.<br />
***&nbsp;&nbsp;lt_f4-chngeafter&nbsp;=&nbsp;space.<br />
***&nbsp;&nbsp;INSERT&nbsp;TABLE&nbsp;lt_f4.<br />
***<br />
***&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;po_grid-&gt;register_f4_for_fields<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it_f4&nbsp;=&nbsp;lt_f4[].<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;ALV_DISPLAY<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_DATA<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;ALV_DISPLAY&nbsp;&nbsp;&nbsp;TABLES&nbsp;&nbsp;&nbsp;PT_TABLE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;PO_GRID&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
**<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;REGISTER_EDIT_EVENT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_ENTER.<br />
**<br />
**<br />
**&nbsp;&nbsp;"ALV&nbsp;GRID#&nbsp;####.<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;PO_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;=&nbsp;GT_EXCLUDE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT[]<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PT_TABLE[]<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_SORT[].<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;REFRESH_TABLE_DISPLAY<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GO_GRID<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;P_<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;REFRESH_TABLE_DISPLAY&nbsp;&nbsp;USING&nbsp;PO_GRID&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_CHECK.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
**<br />
***S:&nbsp;20151005&nbsp;LEWM004&nbsp;MODIFY<br />
**&nbsp;&nbsp;CHECK&nbsp;PO_GRID&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
***E:&nbsp;20151005&nbsp;LEWM004&nbsp;MODIFY<br />
**<br />
***&nbsp;##&nbsp;###&nbsp;##&nbsp;Row/Column##&nbsp;####&nbsp;Data#&nbsp;Refresh<br />
**&nbsp;&nbsp;IF&nbsp;P_CHECK&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;PO_GRID-&gt;REFRESH_TABLE_DISPLAY<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_STABLE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;P_CHECK.<br />
**<br />
***&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;po_grid-&gt;refresh_table_display<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is_stable&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ls_stable<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;i_soft_refresh&nbsp;=&nbsp;'&nbsp;'.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;APPEND_EXCLUDE_FUNCTIONS<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;GT_EXCLUDE[]<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_UND<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;APPEND_EXCLUDE_FUNCTIONS&nbsp;&nbsp;TABLES&nbsp;P_TABLE&nbsp;USING&nbsp;P_VALUE.<br />
**<br />
**&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_EXCLUDE&nbsp;TYPE&nbsp;UI_FUNC.<br />
**<br />
**&nbsp;&nbsp;LS_EXCLUDE&nbsp;=&nbsp;P_VALUE.<br />
**&nbsp;&nbsp;APPEND&nbsp;LS_EXCLUDE&nbsp;TO&nbsp;P_TABLE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;SET_COST_CENTER<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;SET_COST_CREATE_LIST&nbsp;USING&nbsp;PS_DATA&nbsp;LIKE&nbsp;GS_DATA.<br />
**<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_RETURN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_LANGUAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_COSTCENTERLIST.<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_RETURN[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_EXTENSIONIN[]&nbsp;&nbsp;.<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_EXTENSIONOUT[]&nbsp;.<br />
***&gt;&gt;&gt;&nbsp;GS_LANGUAGE&nbsp;&nbsp;##<br />
**&nbsp;&nbsp;GS_LANGUAGE-LANGU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-LANGU.<br />
**&nbsp;&nbsp;GS_LANGUAGE-LANGU_ISO&nbsp;&nbsp;&nbsp;=&nbsp;SY-LANGU.<br />
**<br />
**&nbsp;&nbsp;CONCATENATE&nbsp;SY-DATUM(4)&nbsp;'0101'&nbsp;INTO&nbsp;GS_COSTCENTERLIST-VALID_FROM.<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-VALID_TO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;C_99991231.<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-COSTCENTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;PS_DATA-KOSTL.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-VALID_FROM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-VALID_TO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-PERSON_IN_CHARGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;SY-UNAME.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-DEPARTMENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;'BD2#'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-COSTCENTER_TYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;'L'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;##<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-COSTCTR_HIER_GRP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P_KOKRS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;########<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-COMP_CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;P_KOKRS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-BUS_AREA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-CURRENCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;PS_DATA-WAERS.&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-CURRENCY_ISO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;PS_DATA-WAERS.&nbsp;&nbsp;&nbsp;"&nbsp;ISO&nbsp;##&nbsp;##<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-PROFIT_CTR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;PS_DATA-KOSTL.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-RECORD_QUANTITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####&nbsp;####&nbsp;##&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_ACTUAL_PRIMARY_COSTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;1#&nbsp;###&nbsp;##&nbsp;#####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_PLAN_PRIMARY_COSTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;1######&nbsp;##&nbsp;#####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_ACT_SECONDARY_COSTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;2#&nbsp;###&nbsp;##&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_PLAN_SECONDARY_COSTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;2#&nbsp;###&nbsp;##&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_ACTUAL_REVENUES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;###&nbsp;##&nbsp;#####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_PLAN_REVENUES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###&nbsp;##&nbsp;###<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-LOCK_IND_COMMITMENT_UPDATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;###&nbsp;##&nbsp;#####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-CONDITION_TABLE_USAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#######<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-APPLICATION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;######<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-CSTG_SHEET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ACTY_INDEP_TEMPLATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#######&nbsp;#####&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ACTY_DEP_TEMPLATE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;######&nbsp;#####&nbsp;###<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_TITLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;PS_DATA-KTEXT.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_NAME1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;1<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_NAME2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;2<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_NAME3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;3<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_NAME4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;4<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_STREET&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;#&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_CITY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_DISTRICT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_COUNTRY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_COUNTRY_ISO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ISO&nbsp;###&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_TAXJURCODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_PO_BOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_POSTL_CODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_POBX_PCD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ADDR_REGION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##(#/#,&nbsp;#,&nbsp;#/#)<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_LANGU&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;SY-LANGU.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_LANGU_ISO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;SY-LANGU.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;SAP&nbsp;##&nbsp;##(2#)<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_TELEPHONE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_TELEPHONE2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#&nbsp;##&nbsp;####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_TELEBOX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_TELEX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_FAX_NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_TELETEX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_PRINTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####&nbsp;####&nbsp;##&nbsp;###&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-TELCO_DATA_LINE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;##&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-JV_VENTURE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-JV_REC_IND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-JV_EQUITY_TYP&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-JV_OTYPE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;######&nbsp;######<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-JV_JIBCL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;JIB/JIBE&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-JV_JIBSA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;JIB/JIBE&nbsp;#####A<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;PS_DATA-KTEXT.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####<br />
**&nbsp;&nbsp;GS_COSTCENTERLIST-DESCRIPT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;PS_DATA-KTEXT.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-FUNC_AREA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ACTY_DEP_TEMPLATE_ALLOC_CC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###:&nbsp;######&nbsp;######&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ACTY_INDEP_TEMPLATE_ALLOC_CC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###:&nbsp;######&nbsp;####&nbsp;###&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-FUNC_AREA_LONG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-PERSON_IN_CHARGE_USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-LOGSYSTEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ACTY_DEP_TEMPLATE_SK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###:&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;-&nbsp;###&nbsp;##/####&nbsp;##<br />
***&nbsp;&nbsp;GS_COSTCENTERLIST-ACTY_INDEP_TEMPLATE_SK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###:&nbsp;###&nbsp;###&nbsp;##&nbsp;##&nbsp;##&nbsp;##<br />
**<br />
**&nbsp;&nbsp;APPEND&nbsp;GS_COSTCENTERLIST&nbsp;TO&nbsp;GT_COSTCENTERLIST.<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CODE_CHANGE_KTEXT<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_DATA_CHANGED<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;LS_MOD_CELL<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CODE_CHANGE_KTEXT&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;P_C_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_CHANGED_DATA_PROTOCOL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_S_MOD_CELL&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;P_C_DATA_CHANGED-&gt;MODIFY_CELL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-ROW_ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FIELDNAME&nbsp;=&nbsp;P_S_MOD_CELL-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-VALUE.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CODE_CHANGE_VERAK<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_DATA_CHANGED<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;LS_MOD_CELL<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CODE_CHANGE_VERAK&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;P_C_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_CHANGED_DATA_PROTOCOL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_S_MOD_CELL&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;P_C_DATA_CHANGED-&gt;MODIFY_CELL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-ROW_ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FIELDNAME&nbsp;=&nbsp;P_S_MOD_CELL-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-UNAME.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CODE_CHANGE_WAERS<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ER_DATA_CHANGED<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;LS_MOD_CELL<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CODE_CHANGE_WAERS&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;P_C_DATA_CHANGED<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_CHANGED_DATA_PROTOCOL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_S_MOD_CELL&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
**<br />
**&nbsp;&nbsp;CLEAR:&nbsp;GS_CURRENCY.<br />
**<br />
**&nbsp;&nbsp;TRANSLATE&nbsp;P_S_MOD_CELL-VALUE&nbsp;TO&nbsp;UPPER&nbsp;CASE.<br />
**&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_CURRENCY&nbsp;INTO&nbsp;GS_CURRENCY&nbsp;WITH&nbsp;KEY&nbsp;WAERS&nbsp;=&nbsp;P_S_MOD_CELL-VALUE.<br />
**<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;P_C_DATA_CHANGED-&gt;MODIFY_CELL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-ROW_ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FIELDNAME&nbsp;=&nbsp;P_S_MOD_CELL-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-VALUE.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;P_C_DATA_CHANGED-&gt;MODIFY_CELL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-ROW_ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FIELDNAME&nbsp;=&nbsp;'LTEXT'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_CURRENCY-LTEXT.<br />
**<br />
**&nbsp;&nbsp;ELSE.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;P_C_DATA_CHANGED-&gt;MODIFY_CELL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_S_MOD_CELL-ROW_ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FIELDNAME&nbsp;=&nbsp;P_S_MOD_CELL-FIELDNAME<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DATA-WAERS.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000&nbsp;WITH&nbsp;P_S_MOD_CELL-VALUE&nbsp;TEXT-E11&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
**<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;BAPI_CHANGE_COST<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;BAPI_CHANGE_COST&nbsp;.<br />
**<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_COSTCENTERLIST,&nbsp;GT_RETURN,&nbsp;GS_LANGUAGE,&nbsp;GS_CSKS,&nbsp;GS_DATA.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WHERE&nbsp;ICON&nbsp;=&nbsp;ICON_YELLOW_LIGHT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;DB_CHANGE&nbsp;=&nbsp;'X'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_CSKS&nbsp;INTO&nbsp;GS_CSKS&nbsp;WITH&nbsp;KEY&nbsp;KOKRS&nbsp;=&nbsp;GS_DATA-KOKRS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KOSTL&nbsp;=&nbsp;GS_DATA-KOSTL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATBI&nbsp;=&nbsp;C_99991231.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;BAPI_MAKE_CHANGE_LIST.<br />
**<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_COSTCENTER_CHANGEMULTIPLE'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTROLLINGAREA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DATA-KOKRS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TESTRUN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MASTER_DATA_INACTIVE&nbsp;=&nbsp;'&nbsp;'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LANGUAGE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LANGUAGE<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RESET_FILLED_FIELDS&nbsp;&nbsp;=&nbsp;'&nbsp;'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;COSTCENTERLIST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_COSTCENTERLIST<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_RETURN.<br />
**<br />
**&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_RETURN&nbsp;INTO&nbsp;GS_RETURN&nbsp;WITH&nbsp;KEY&nbsp;TYPE&nbsp;=&nbsp;'E'.<br />
**<br />
***&nbsp;##&nbsp;##&nbsp;#&nbsp;-----------------------------------------------------------------<br />
**&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GV_MESSAGE.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'MESSAGE_TEXT_BUILD'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSGID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RETURN-ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSGNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RETURN-NUMBER<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSGV1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RETURN-MESSAGE_V1<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSGV2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RETURN-MESSAGE_V2<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSGV3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RETURN-MESSAGE_V3<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MSGV4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_RETURN-MESSAGE_V4<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE_TEXT_OUTPUT&nbsp;=&nbsp;GV_MESSAGE.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_TRANSACTION_ROLLBACK'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;=&nbsp;GS_RETURN.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;####&nbsp;##&nbsp;###&nbsp;#&nbsp;ICON&nbsp;##------------------------------<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WHERE&nbsp;ICON&nbsp;=&nbsp;ICON_YELLOW_LIGHT.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FAIL_TO_UPDATE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;TEXT-E12&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"&nbsp;#####&nbsp;###&nbsp;#######.<br />
**<br />
***&nbsp;##&nbsp;#&nbsp;-----------------------------------------------------------------<br />
**&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'BAPI_TRANSACTION_COMMIT'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAIT&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN&nbsp;=&nbsp;GS_RETURN.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;TEXT-S04.&nbsp;"&nbsp;#####&nbsp;###&nbsp;#######.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;#&nbsp;#####&nbsp;####&nbsp;(ALV,&nbsp;DB)&nbsp;------------------------------<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WHERE&nbsp;ICON&nbsp;=&nbsp;ICON_YELLOW_LIGHT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;DB_CHANGE&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;UPDATE_DATA.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
**<br />
***&nbsp;&nbsp;&nbsp;####&nbsp;ZTBD2_12_07&nbsp;####&nbsp;##&nbsp;-----------------------------------<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_DATA_TO_DB.<br />
**<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;BDC_CHANGE_COST<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;BDC_CHANGE_COST&nbsp;.<br />
**<br />
**&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_BDC,&nbsp;GT_MSG,&nbsp;GS_DATA,&nbsp;GS_CSKS.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;WHERE&nbsp;ICON&nbsp;=&nbsp;ICON_YELLOW_LIGHT<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;DB_CHANGE&nbsp;=&nbsp;'X'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_CSKS&nbsp;INTO&nbsp;GS_CSKS&nbsp;WITH&nbsp;KEY&nbsp;KOKRS&nbsp;=&nbsp;GS_DATA-KOKRS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KOSTL&nbsp;=&nbsp;GS_DATA-KOSTL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATBI&nbsp;=&nbsp;C_99991231.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;CSKS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KOSTL&nbsp;=&nbsp;@GS_DATA-KOSTL<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@DATA(LS_DATA).<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;DYNPRO&nbsp;USING&nbsp;:<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;'SAPLKMA1'&nbsp;&nbsp;&nbsp;&nbsp;'0200',<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'BDC_OKCODE'&nbsp;&nbsp;'/00',<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-KOKRS'&nbsp;P_KOKRS,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-KOSTL'&nbsp;GS_DATA-KOSTL.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;DYNPRO&nbsp;USING&nbsp;:<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;'SAPLKMA1'&nbsp;&nbsp;&nbsp;&nbsp;'0299',<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'BDC_OKCODE'&nbsp;&nbsp;'/00',<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-KTEXT'&nbsp;GS_DATA-KTEXT,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-LTEXT'&nbsp;GS_DATA-KTEXT,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-VERAK'&nbsp;GS_DATA-VERAK,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-KOSAR'&nbsp;C_KOSAR,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-KHINR'&nbsp;C_KHINR,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-WAERS'&nbsp;GS_DATA-WAERS,<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'CSKSZ-PRCTR'&nbsp;'ZBD212'.<br />
**<br />
**<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;DYNPRO&nbsp;USING&nbsp;:<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;'SAPLSPO1'&nbsp;&nbsp;&nbsp;&nbsp;'0300',<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'BDC_OKCODE'&nbsp;&nbsp;'=YES'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_DATA-WAERS&nbsp;&lt;&gt;&nbsp;GS_DATA-WAERS.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;DYNPRO&nbsp;USING&nbsp;:<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;'SAPLSPO1'&nbsp;&nbsp;&nbsp;&nbsp;'0300',<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'BDC_OKCODE'&nbsp;&nbsp;'=YES'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;DYNPRO&nbsp;USING&nbsp;:<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'X'&nbsp;'SAPLKMA1'&nbsp;&nbsp;&nbsp;&nbsp;'0299',<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'&nbsp;'&nbsp;'BDC_OKCODE'&nbsp;&nbsp;'=BU'.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;'KS02'&nbsp;USING&nbsp;GT_BDC&nbsp;MODE&nbsp;'N'&nbsp;MESSAGES&nbsp;INTO&nbsp;GT_MSG.<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_MSG&nbsp;INTO&nbsp;GS_MSG&nbsp;WITH&nbsp;KEY&nbsp;MSGID&nbsp;=&nbsp;'E'.<br />
***&nbsp;&nbsp;&nbsp;###&nbsp;------------------------------------------------------------------------------<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
**<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;###&nbsp;####&nbsp;(ALV,&nbsp;DB)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;UPDATE_DATA.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;TEXT-S04.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####&nbsp;###&nbsp;##&nbsp;#####.<br />
**<br />
***&nbsp;&nbsp;&nbsp;###&nbsp;------------------------------------------------------------------------------<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_MSG&nbsp;INTO&nbsp;GS_MSG&nbsp;WITH&nbsp;KEY&nbsp;MSGTYP&nbsp;=&nbsp;'E'.&nbsp;"##<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MESSAGE_TEXT.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;####&nbsp;##&nbsp;###&nbsp;#&nbsp;ICON&nbsp;##------------------------------<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;FAIL_TO_UPDATE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;TEXT-E09&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;&nbsp;"&nbsp;#####&nbsp;###&nbsp;##&nbsp;#####.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_BDC,&nbsp;GT_MSG[],&nbsp;GS_DATA.<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
***&nbsp;&nbsp;&nbsp;####&nbsp;ZTBD2_12_07&nbsp;####&nbsp;##<br />
**&nbsp;&nbsp;PERFORM&nbsp;SAVE_DATA_TO_DB.<br />
**<br />
**ENDFORM.<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;Form&nbsp;CHOICE_LINES<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;text<br />
***&---------------------------------------------------------------------*<br />
***&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;--&nbsp;GV_CHK<br />
***&---------------------------------------------------------------------*<br />
**FORM&nbsp;CHOICE_LINES&nbsp;&nbsp;CHANGING&nbsp;PV_CHK.<br />
**<br />
**&nbsp;&nbsp;DATA:&nbsp;LV_LINES&nbsp;TYPE&nbsp;I.<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;ET_ROW_NO.<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_GRID-&gt;GET_SELECTED_ROWS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;=&nbsp;ET_ROW_NO.<br />
**<br />
**&nbsp;&nbsp;DELETE&nbsp;ET_ROW_NO&nbsp;WHERE&nbsp;ROW_ID&nbsp;&lt;=&nbsp;0.<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;(&nbsp;ET_ROW_NO[]&nbsp;IS&nbsp;INITIAL&nbsp;).<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000&nbsp;WITH&nbsp;TEXT-E18&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;####&nbsp;####.&nbsp;##&nbsp;#&nbsp;####&nbsp;###&nbsp;##&nbsp;#&nbsp;#,&nbsp;##&nbsp;######.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PV_CHK&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;ET_ROW_NO&nbsp;INTO&nbsp;ES_ROW_NO.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA-DB_CHANGE&nbsp;=&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA&nbsp;FROM&nbsp;GS_DATA&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;DB_CHANGE.<br />
**<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2021. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
